<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‚¹å‡»æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .clickable-area {
            position: relative;
            display: inline-block;
            cursor: pointer;
            border: 2px dashed #3b82f6;
            border-radius: 8px;
            padding: 20px;
            margin: 10px;
            transition: all 0.3s ease;
            background: #f8fafc;
        }
        .clickable-area:hover {
            border-color: #1d4ed8;
            background: #eff6ff;
            box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);
        }
        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #dcfce7; color: #166534; }
        .error { background: #fecaca; color: #991b1b; }
        .info { background: #dbeafe; color: #1e40af; }
    </style>
</head>
<body>
    <h1>ğŸ”§ ç‚¹å‡»åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-container">
        <h2>æµ‹è¯•1: åŸºæœ¬ç‚¹å‡»åŠŸèƒ½</h2>
        <div class="clickable-area" id="test1" onclick="testBasicClick()">
            <p>ç‚¹å‡»è¿™ä¸ªåŒºåŸŸæµ‹è¯•åŸºæœ¬åŠŸèƒ½</p>
            <p style="font-size: 12px; color: #666;">åº”è¯¥çœ‹åˆ°æ‰‹æŒ‡æŒ‡é’ˆå¹¶èƒ½ç‚¹å‡»</p>
        </div>
        <div id="status1" class="status info">ç­‰å¾…ç‚¹å‡»...</div>
    </div>
    
    <div class="test-container">
        <h2>æµ‹è¯•2: å›¾ç‰‡ç‚¹å‡»åŠŸèƒ½</h2>
        <div class="clickable-area" onclick="testImageClick()">
            <img src="/api/health/image/7/theta" 
                 style="max-width: 200px; border-radius: 4px;"
                 onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtc2l6ZT0iMTQiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj7lm77lg4/kuI3lrZjlnKg8L3RleHQ+PC9zdmc+'"
                 alt="æµ‹è¯•å›¾ç‰‡" />
            <p style="font-size: 12px; color: #666;">ç‚¹å‡»å›¾ç‰‡åœ¨æ–°çª—å£æ‰“å¼€</p>
        </div>
        <div id="status2" class="status info">ç­‰å¾…ç‚¹å‡»...</div>
    </div>
    
    <div class="test-container">
        <h2>æµ‹è¯•3: å¤šç§å›¾ç‰‡ç±»å‹</h2>
        <div style="display: flex; flex-wrap: wrap; gap: 10px;">
            <div class="clickable-area" onclick="testImageType('alpha')" style="text-align: center; min-width: 120px;">
                <p style="margin: 0;">Alphaæ³¢</p>
                <small>ç‚¹å‡»æµ‹è¯•</small>
            </div>
            <div class="clickable-area" onclick="testImageType('beta')" style="text-align: center; min-width: 120px;">
                <p style="margin: 0;">Betaæ³¢</p>
                <small>ç‚¹å‡»æµ‹è¯•</small>
            </div>
            <div class="clickable-area" onclick="testImageType('gamma')" style="text-align: center; min-width: 120px;">
                <p style="margin: 0;">Gammaæ³¢</p>
                <small>ç‚¹å‡»æµ‹è¯•</small>
            </div>
        </div>
        <div id="status3" class="status info">ç­‰å¾…ç‚¹å‡»...</div>
    </div>
    
    <div class="test-container">
        <h2>ğŸ” è°ƒè¯•ä¿¡æ¯</h2>
        <div id="debug-info" style="background: #f1f5f9; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 12px;">
            <div>User Agent: <span id="user-agent"></span></div>
            <div>Window.open available: <span id="window-open-check"></span></div>
            <div>Current URL: <span id="current-url"></span></div>
        </div>
    </div>
    
    <script>
        // åˆå§‹åŒ–è°ƒè¯•ä¿¡æ¯
        document.getElementById('user-agent').textContent = navigator.userAgent;
        document.getElementById('window-open-check').textContent = typeof window.open === 'function' ? 'Yes' : 'No';
        document.getElementById('current-url').textContent = window.location.href;
        
        function updateStatus(id, message, type = 'info') {
            const element = document.getElementById(id);
            element.textContent = message;
            element.className = `status ${type}`;
        }
        
        function testBasicClick() {
            console.log('åŸºæœ¬ç‚¹å‡»æµ‹è¯•è¢«è§¦å‘');
            updateStatus('status1', 'âœ… ç‚¹å‡»äº‹ä»¶æˆåŠŸè§¦å‘!', 'success');
            
            try {
                const newWindow = window.open('about:blank', '_blank', 'width=400,height=300');
                if (newWindow) {
                    newWindow.document.write('<h1>æµ‹è¯•æˆåŠŸ!</h1><p>ç‚¹å‡»åŠŸèƒ½æ­£å¸¸å·¥ä½œ</p>');
                    updateStatus('status1', 'âœ… æ–°çª—å£æ‰“å¼€æˆåŠŸ!', 'success');
                    setTimeout(() => newWindow.close(), 3000);
                } else {
                    updateStatus('status1', 'âš ï¸ æ–°çª—å£è¢«é˜»æ­¢ï¼Œè¯·å…è®¸å¼¹çª—', 'error');
                }
            } catch (e) {
                updateStatus('status1', 'âŒ é”™è¯¯: ' + e.message, 'error');
            }
        }
        
        function testImageClick() {
            console.log('å›¾ç‰‡ç‚¹å‡»æµ‹è¯•è¢«è§¦å‘');
            updateStatus('status2', 'âœ… å›¾ç‰‡ç‚¹å‡»äº‹ä»¶æˆåŠŸè§¦å‘!', 'success');
            
            try {
                const imageUrl = '/api/health/image/7/theta';
                const newWindow = window.open(imageUrl, '_blank', 'width=800,height=600,scrollbars=yes,resizable=yes');
                if (newWindow) {
                    updateStatus('status2', 'âœ… å›¾ç‰‡æ–°çª—å£æ‰“å¼€æˆåŠŸ!', 'success');
                } else {
                    updateStatus('status2', 'âš ï¸ å›¾ç‰‡æ–°çª—å£è¢«é˜»æ­¢ï¼Œè¯·å…è®¸å¼¹çª—', 'error');
                }
            } catch (e) {
                updateStatus('status2', 'âŒ é”™è¯¯: ' + e.message, 'error');
            }
        }
        
        function testImageType(type) {
            console.log(`${type}å›¾ç‰‡ç‚¹å‡»æµ‹è¯•è¢«è§¦å‘`);
            updateStatus('status3', `âœ… ${type}å›¾ç‰‡ç‚¹å‡»äº‹ä»¶æˆåŠŸè§¦å‘!`, 'success');
            
            try {
                const imageUrl = `/api/health/image/7/${type}`;
                const newWindow = window.open(imageUrl, '_blank', 'width=800,height=600,scrollbars=yes,resizable=yes');
                if (newWindow) {
                    updateStatus('status3', `âœ… ${type}å›¾ç‰‡æ–°çª—å£æ‰“å¼€æˆåŠŸ!`, 'success');
                } else {
                    updateStatus('status3', `âš ï¸ ${type}å›¾ç‰‡æ–°çª—å£è¢«é˜»æ­¢ï¼Œè¯·å…è®¸å¼¹çª—`, 'error');
                }
            } catch (e) {
                updateStatus('status3', `âŒ é”™è¯¯: ${e.message}`, 'error');
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„æ£€æŸ¥
        window.onload = function() {
            console.log('ç‚¹å‡»æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            console.log('æ‰€æœ‰åŠŸèƒ½å·²å°±ç»ª');
        };
    </script>
</body>
</html> 